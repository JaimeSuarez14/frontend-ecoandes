<div class="flex h-screen bg-[#f5f6fa]">
  <!-- Sidebar -->
  <aside
    [class]="' text-white bg-black transition-all duration-300 ease-in overflow-hidden ' + (sidebarCollapsed ? 'w-16' : 'w-[250px]')">
    <div
      [class]="'flex items-center  border-b-2 border-white/20 ' + (sidebarCollapsed ? 'p-0.5 gap-0.5' : 'p-2 gap-2')">
      <a routerLink="/"><img src="assets/img/Andes_Cafe.png" alt="Logo"
          [class]="' ' + (sidebarCollapsed ? 'w-full h-auto' : 'h-7 w-auto')"></a>
      <h3 *ngIf="!sidebarCollapsed" class="m-0 text-lg font-bold">EcoAndes</h3>
      <button class="cursor-pointer ml-auto text-lg p-1 rounded-full hover:bg-white/20" (click)="toggleSidebar()">
        <i class="fas fa-bars"></i>
      </button>
    </div>

    <nav [class]="' '+ (sidebarCollapsed ? 'p-2' : 'p-4')">
      <a routerLink="/admin"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400"
        [routerLinkActiveOptions]="{ exact: true }">
        <i class="fas fa-tachometer-alt text-center"></i>
        <span *ngIf="!sidebarCollapsed">Dashboard</span>
      </a>

      <a *appHasRold="'ADMIN'"
        routerLink="/admin/usuarios"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
        <i class="fas fa-project-diagram text-center"></i>
        <span *ngIf="!sidebarCollapsed">Usuarios</span>
      </a>

      <a *appHasRold="'ADMIN'" routerLink="/admin/consultas"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
        <i class="fas fa-tasks"></i>
        <span *ngIf="!sidebarCollapsed">Consultas</span>
      </a>

      <a *appHasRold="'ADMIN'" routerLink="/admin/mensajes"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
        <i class="fas fa-users"></i>
        <span *ngIf="!sidebarCollapsed">Mensajes</span>
      </a>

      <a *appHasRold="'ADMIN'" routerLink="/admin/productos"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
        <i class="fas fa-building"></i>
        <span *ngIf="!sidebarCollapsed">Productos</span>
      </a>

      <div class="group">
        <a routerLink="/admin/configuración"
          [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
          routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
          <i class="fas fa-briefcase"></i>
          @if(!sidebarCollapsed){
          <span>Configuración</span>
          <i class="fa-solid fa-angle-up group rotate-90 group-hover:rotate-180 transition-transform duration-700 ease-in-out"></i>
          }
        </a>
        <div
          class="max-h-0 group-hover:max-h-[500px]  flex flex-col overflow-hidden transition-all duration-700 ease-in-out">
          <a routerLink="/admin/configuración"
            [class]="'flex items-center gap-2 ml-1 py-1 transition-colors duration-300 ease-in-out  hover:text-amber-200 mb-2 hover:border text-sm hover:border-amber-50/50 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
            routerLinkActive="font-bold text-green-400 border-y-2 border-green-400"><i
              class="fa-regular fa-circle-user"></i>@if(!sidebarCollapsed){
            <span>Perfil</span>
            }</a>

          <a routerLink="/admin/configuración"
            [class]="'flex items-center gap-2 ml-1 py-1 transition-colors duration-300 ease-in-out  hover:text-amber-200 mb-2 hover:border text-sm hover:border-amber-50/50 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
            routerLinkActive="font-bold text-green-400 border-y-2 border-green-400"><i
              class="fa-solid fa-screwdriver-wrench"></i>@if(!sidebarCollapsed){
            <span>General</span>
            }</a>

        </div>
      </div>
      <button  type="button"
        [class]="'flex items-center gap-2 ml-1 py-2 transition-colors duration-300 ease-in-out text-red-500 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400"
        (click)="authService.logout()"
        ><i
          class="fa-solid fa-sign-out-alt"></i>@if(!sidebarCollapsed){
        <span>Cerrar sesión</span>
        }</button>
    </nav>
  </aside>

  <!-- Main content area -->
  <div class="flex flex-1 flex-col overflow-hidden">
    <!-- Top bar -->
    <header class="white py-4 px-2 border-b border-[#e9ecef] flex justify-between items-center shadow-lg">
      <div class="top-bar-left">
        <h2 class="text-2xl text-amber-900">{{ 'Panel de '+getPageTitle()}}</h2>
      </div>

      <div class="flex items-center gap-4 p-1 hover:bg-amber-50/50">
        <div class="w-8 h-8 text-lg rounded-full border bg-amber-800/10 border-amber-500 flex justify-center items-center">
          <i class="fa-solid fa-user-tie text-amber-950"></i> 
        </div>
        <div class="flex flex-col items-end ">
          <span class="font-bold text-amber-800 p-0 m-0">{{authService.currentUserAuth$()?.username | titlecase}}</span>
          <span class="text-xs font-bold text-gray-400 uppercase m-0 p-0">{{authService.currentUserAuth$()?.rol}}</span>
        </div>
        <div class="px-0.5 border border-gray-300 h-[39px] flex justify-center items-center rounded-lg cursor-pointer hover:border-gray-500 ">
          <i class="bi bi-caret-down-fill"></i>
        </div>
        <!-- <button
          class="bg-red-500 text-white py-2 px-4 rounded-lg cursor-pointer hover:bg-red-400 transition-colors duration-200 ease-in text-sm font-bold "
          (click)="logout()">
          <i class="fas fa-sign-out-alt"></i>
        </button> -->
      </div>
    </header>

    <!-- Page content -->
    <main class="flex-1 p-4 overflow-y-auto">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>