<div class="flex h-screen bg-[#f5f6fa]">
  <!-- Sidebar -->
  <aside
    [class]="' text-white bg-black transition-all duration-300 ease-in overflow-hidden ' + (sidebarCollapsed ? 'w-16' : 'w-[250px]')">
    <div
      [class]="'flex items-center  border-b-2 border-white/20 ' + (sidebarCollapsed ? 'p-0.5 gap-0.5' : 'p-2 gap-2')">
      <a routerLink="/"><img src="assets/img/Andes_Cafe.png" alt="Logo"
          [class]="' ' + (sidebarCollapsed ? 'w-full h-auto' : 'h-7 w-auto')"></a>
      <h3 *ngIf="!sidebarCollapsed" class="m-0 text-lg font-bold">EcoAndes</h3>
      <button class="cursor-pointer ml-auto text-lg p-1 rounded-full hover:bg-white/20" (click)="toggleSidebar()">
        <i class="fas fa-bars"></i>
      </button>
    </div>

    <nav [class]="' '+ (sidebarCollapsed ? 'p-2' : 'p-4')">
      <a routerLink="/admin"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400"
        [routerLinkActiveOptions]="{ exact: true }">
        <i class="fas fa-tachometer-alt text-center"></i>
        <span *ngIf="!sidebarCollapsed">Dashboard</span>
      </a>

      <a *appHasRold="'ADMIN'" routerLink="/admin/usuarios"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
        <i class="fas fa-project-diagram text-center"></i>
        <span *ngIf="!sidebarCollapsed">Usuarios</span>
      </a>

      <a *appHasRold="'ADMIN'" routerLink="/admin/consultas"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
        <i class="fas fa-tasks"></i>
        <span *ngIf="!sidebarCollapsed">Consultas</span>
      </a>

      <a *appHasRold="'ADMIN'" routerLink="/admin/mensajes"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
        <i class="fas fa-users"></i>
        <span *ngIf="!sidebarCollapsed">Mensajes</span>
      </a>

      <a *appHasRold="'ADMIN'" routerLink="/admin/productos"
        [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
        <i class="fas fa-building"></i>
        <span *ngIf="!sidebarCollapsed">Productos</span>
      </a>

      <div class="group">
        <a routerLink="/admin/configuración"
          [class]="'flex items-center gap-3 py-2 transition-colors duration-300 ease-in-out border-l-2 border-amber-100 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
          routerLinkActive="font-bold text-green-400 border-y-2 border-green-400">
          <i class="fas fa-briefcase"></i>
          @if(!sidebarCollapsed){
          <span>Configuración</span>
          <i
            class="fa-solid fa-angle-up group rotate-90 group-hover:rotate-180 transition-transform duration-700 ease-in-out"></i>
          }
        </a>
        <div
          class="max-h-0 group-hover:max-h-[500px]  flex flex-col overflow-hidden transition-all duration-700 ease-in-out">
          <a routerLink="/admin/configuración"
            [class]="'flex items-center gap-2 ml-1 py-1 transition-colors duration-300 ease-in-out  hover:text-amber-200 mb-2 hover:border text-sm hover:border-amber-50/50 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
            routerLinkActive="font-bold text-green-400 border-y-2 border-green-400"><i
              class="fa-regular fa-circle-user"></i>@if(!sidebarCollapsed){
            <span>Perfil</span>
            }</a>

          <a routerLink="/admin/configuración"
            [class]="'flex items-center gap-2 ml-1 py-1 transition-colors duration-300 ease-in-out  hover:text-amber-200 mb-2 hover:border text-sm hover:border-amber-50/50 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
            routerLinkActive="font-bold text-green-400 border-y-2 border-green-400"><i
              class="fa-solid fa-screwdriver-wrench"></i>@if(!sidebarCollapsed){
            <span>General</span>
            }</a>

        </div>
      </div>
      <button type="button"
        [class]="'flex items-center gap-2 ml-1 py-2 transition-colors duration-300 ease-in-out text-red-500 hover:text-amber-200 mb-2 ' + (sidebarCollapsed ? ' justify-center w-full' : 'px-4')"
        routerLinkActive="font-bold text-green-400 border-y-2 border-green-400" (click)="authService.logout()"><i
          class="fa-solid fa-sign-out-alt"></i>@if(!sidebarCollapsed){
        <span>Cerrar sesión</span>
        }</button>
    </nav>
  </aside>

  <!-- Main content area -->
  <div class="flex flex-1 flex-col overflow-hidden">
    <!-- Top bar -->
    <header class="white py-4 px-2 border-b border-[#e9ecef] flex justify-between items-center shadow-lg">
      <div class="top-bar-left">
        <h2 class="text-2xl text-amber-900">{{ 'Panel de '+getPageTitle()}}</h2>
      </div>

      <div class="group flex items-center gap-4 p-1 hover:bg-amber-50/80 relative">
        <div
          class="w-8 h-8 text-lg rounded-full border bg-amber-800/10 border-amber-500 flex justify-center items-center">
          <i class="fa-solid fa-user-tie text-amber-950"></i>
        </div>
        <div class="flex flex-col items-end ">
          <span class="font-bold text-amber-800 p-0 m-0">{{authService.currentUserAuth$()?.username | titlecase}}</span>
          <span class="text-xs font-bold text-gray-400 uppercase m-0 p-0">{{authService.currentUserAuth$()?.rol}}</span>
        </div>
        <div
          class="px-0.5 border-2 border-gray-200 h-[39px] flex justify-center items-center rounded-md cursor-pointer group-hover:border-gray-500/50 ">
          <i class="bi bi-caret-down-fill transform duration-300 transition-transform group-hover:rotate-90"></i>
        </div>
        <div
          class="absolute w-64 rounded-md  top-12 max-h-0 right-0 group-hover:max-h-[500px] bg-amber-50 overflow-hidden transition-all duration-400 ease-in-out text-amber-900 z-50">
          <div class="p-2 bg-amber-400/50 transition-all duration-400 ease-in-out flex flex-col gap-1 items-start">
            <a routerLink="/admin/perfil-login"
              class=" text-black py-0.5 w-full px-1 text-left rounded-lg cursor-pointer hover:opacity-50 transition-colors duration-200 ease-in text-sm font-bold "
              (click)="logout()">
              <i class="bi bi-person-bounding-box text-white p-1 mr-2 rounded-md bg-blue-500"></i>
              Ver Perfil
            </a>
            <button
              class=" text-black py-0.5 w-full px-1 text-left rounded-lg cursor-pointer hover:bg-white/50 transition-colors duration-200 ease-in text-sm font-bold "
              (click)="logout()">
              <i class="bi bi-arrow-clockwise text-white p-1 mr-2 rounded-md bg-yellow-500"></i>
              Actualzar Info
            </button>
            <button
              class=" text-black py-0.5 w-full px-1 text-left rounded-lg cursor-pointer hover:bg-white/50 transition-colors duration-200 ease-in text-sm font-bold "
              (click)="authService.logout()">
              <span class=" text-white p-0.5 mr-2 rounded-md bg-red-500"><i
                  class="fas fa-sign-out-alt text-sm"></i></span>

              Salir
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Page content -->
    <main class="flex-1 overflow-y-auto">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>